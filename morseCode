const int switchPin = 2; //input pin
const int LED = 13;

const int inputPin = 5; //grey input dots and dashes
const int endPin = 6; //red stop word
const int spacePin = 7; //blue spaces inbetween words
const int startPin = 8; //green start a word
int overflowCounter = 0; //Overflow of TNCT1

long startTime;
long duration;
float secDuration;
int count=0;
bool LightOn = false;
bool ToneOn = false;
int digitCount=0;
out=[];

//const char dot ".";
//const char dash "-";


void setup() {

  pinMode(switchPin, INPUT_PULLUP);
  pinMode(inputPin, INPUT);
  pinMode(endPin, INPUT);
  pinMode(spacePin, INPUT);
  pinMode(startPin, INPUT);
  pinMode(LED_BUILTIN, OUTPUT);
  Serial.begin(9600); //sets up communications with serial monitor
  attachInterrupt(0, trigger, HIGH); // interrupt 0 is mapped to pin2 on the Arduino Uno

  TIMSK1 = 0x6;
  OCR1A = 255;

}

void loop() {

  if(digitalRead(5)==HIGH){
  	//letter sensing shit here

    if(digitalRead(2)==HIGH){
      startTime = millis();
    }
    if(LightOn){
      digitalWrite(LED, HIGH);
    }
    while (digitalRead(2)==HIGH){
    }
    stop=millis();
    digitalWrite(LED,LOW);
    LightOn=false;
    digitCount++;
    duration = stop-startTime;
    switch(duration){
      case <750:
        out[digitCount-1]=".";
      case >= 750:
        out[digitCount-1]="-";
    }
  }
  else if(digitalRead(6)==HIGH){
  	//end a word here
    outsize=out.length();
    for (i=0; i<outsize; i++){
      serial.print(out[i]);
    }
    out=[];
    digitCount=0;
  }
  else if(digitalRead(7)==HIGH){
  	//space
    out[digitCount-1]=" ";
  }
  else if(digitalRead(8)==HIGH){
    //start a word here
    out=[];
  }
}


void trigger(){
  //Serial.println(TCNT1);
  LightOn = true;
  ToneON = !ToneOn;
  count++;
}


ISR(TCNT1_COMPA_vect){
  overflowCounter ++;
}
